import torch
import torch.nn.functional as F

x1 = torch.tensor([
    [0, 0, 0, 1, 1, 9, 57, 49, 43, 128, 8, 0, 2, 64, 67, 80, 61, 65, 60, 57, 45, 37, 32, 34, 68, 72, 94, 49, 0, 0],
    [0, 0, 0, 0, 0, 16, 57, 45, 26, 79, 130, 47, 0, 35, 68, 86, 95, 71, 43, 120, 241, 139, 101, 197, 117, 93, 104, 67, 0, 0],
    [0, 0, 0, 0, 0, 2, 56, 39, 37, 45, 97, 141, 116, 119, 95, 41, 34, 43, 58, 135, 227, 196, 187, 239, 79, 49, 83, 74, 0, 0]
])

x2 = torch.tensor([
    [0, 0, 0, 0, 0, 16, 57, 45, 26, 79, 130, 47, 0, 35, 68, 86, 95, 71, 43, 120, 241, 139, 101, 197, 117, 93, 104, 67, 0, 0],
    [0, 0, 0, 0, 0, 2, 56, 39, 37, 45, 97, 141, 116, 119, 95, 41, 34, 43, 58, 135, 227, 196, 187, 239, 79, 49, 83, 74, 0, 0],
    [0,0,0,1,0,4,71,32,37,45,45,69,128,100,120,132,123,135,171,179,161,127,122,183 ,100,39 ,68,76 ,0,0]
])

x3 = torch.tensor([
    [0, 0, 0, 0, 0, 2, 56, 39, 37, 45, 97, 141, 116, 119, 95, 41, 34, 43, 58, 135, 227, 196, 187, 239, 79, 49, 83, 74, 0, 0],
    [0,0,0,1,0,4,71,32,37,45,45,69,128,100,120,132,123,135,171,179,161,127,122,183  ,100,39 ,68,76  ,0,0],
    [0,0,0,1,0,1,76,47,28,47,74,38,52,58,43,98,122,146,228,165,159,178,164,179,246,86,56,82,1,0]
])

x4 = torch.tensor([
    [0,0,0,1,0,4,71,32,37,45,45,69,128,100,120,132,123,135,171,179,161,127,122,183  ,100,39 ,68,76  ,0,0],
    [0,0,0,1,0,1,76,47,28,47,74,38,52,58,43,98,122,146,228,165,159,178,164,179,246,86,56,82,1,0],
    [0,0,0,0,0,1,89,157,165,171,93,52,56,60,83,82,58,89,157,174,201,198,178,200,130,67,78,75,1,0]
])

x5 = torch.tensor([
    [0,0,0,1,0,1,76,47,28,47,74,38,52,58,43,98,122,146,228,165,159,178,164,179,246,86,56,82,1,0],
    [0,0,0,0,0,1,89,157,165,171,93,52,56,60,83,82,58,89,157,174,201,198,178,200,130,67,78,75,1,0],
    [0,0,2,1,0,4,60,49,71,64,64,69,79,91,54,31,58,75,54,57,52,115,254,132,34,63,74,72,0,0]
])


x6 = torch.tensor([
    [0,0,0,0,0,1,89,157,165,171,93,52,56,60,83,82,58,89,157,174,201,198,178,200,130,67,78,75,1,0],
    [0,0,2,1,0,4,60,49,71,64,64,69,79,91,54,31,58,75,54,57,52,115,254,132,34,63,74,72,0,0],
    [0,1,0,0,0,4,85,74,67,68,69,74,80,94,56,52,85,104,105,87,69,63,141,93,87,89,101,85,2,0]
])

x7 = torch.tensor([
    [0,0,2,1,0,4,60,49,71,64,64,69,79,91,54,31,58,75,54,57,52,115,254,132,34,63,74,72,0,0],
    [0,1,0,0,0,4,85,74,67,68,69,74,80,94,56,52,85,104,105,87,69,63,141,93,87,89,101,85,2,0],
    [0,26,16,0,2,0,79,115,89,100,98,100,100,108,86,76,83,93,119,112,112,112,94,102,91,75,41,16,20,0]
])


# Add dimensions for channels and batch size
x1 = x1.unsqueeze(0).unsqueeze(0).float()
x2 = x2.unsqueeze(0).unsqueeze(0).float()
x3 = x3.unsqueeze(0).unsqueeze(0).float()
x4 = x4.unsqueeze(0).unsqueeze(0).float()
x5 = x5.unsqueeze(0).unsqueeze(0).float()
x6 = x6.unsqueeze(0).unsqueeze(0).float()
x7 = x7.unsqueeze(0).unsqueeze(0).float()

kernel = torch.tensor([
    [-15, 10, 16],
    [-12, -15, 13],
    [26, -19, -7]
]).unsqueeze(0).unsqueeze(0).float()

bias = torch.tensor([459], dtype=torch.float)

output1 = F.conv2d(x1, kernel, padding=0, stride=1, bias=bias)
print(output1)
output2 = F.conv2d(x2, kernel, padding=0, stride=1, bias=bias)
print(output2)
output3 = F.conv2d(x3, kernel, padding=0, stride=1, bias=bias)
print(output3)
output4 = F.conv2d(x4, kernel, padding=0, stride=1, bias=bias)
print(output4)
output5 = F.conv2d(x5, kernel, padding=0, stride=1, bias=bias)
print(output5)
output6 = F.conv2d(x6, kernel, padding=0, stride=1, bias=bias)
print(output6)
output7 = F.conv2d(x7, kernel, padding=0, stride=1, bias=bias)
print(output7)

print("DONE")
